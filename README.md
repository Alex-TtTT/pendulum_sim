æœ¬é¡¹ç›®å°†åŒä¸€å¥—ä»£ç æ‹†åˆ†ä¸º **æ ¸å¿ƒä»¿çœŸæ¨¡å—**ï¼ˆPython è„šæœ¬ï¼‰ä¸ **å¯è§†åŒ–/ç¤ºä¾‹**ï¼ˆJupyter Notebookï¼‰ä¸¤éƒ¨åˆ†ï¼š

- **`pendulum_sim.py`**
  - æä¾›å‚æ•°æ•°æ®ç±» `Params` ä¸ä¸»å‡½æ•° `simulate(params)`ï¼›
  - åªåšæ•°å€¼ç§¯åˆ†å’Œæ•°æ®äº§å‡ºï¼Œä¸è¿›è¡Œç»˜å›¾ï¼Œä¾¿äºä½ åœ¨ä»»ä½•ç¯å¢ƒ/å·¥ç¨‹ä¸­å¤ç”¨ã€‚
- **`demo.ipynb`**
  - æ¼”ç¤ºå¦‚ä½•è®¾ç½®å‚æ•°ã€è°ƒç”¨ `simulate` å¹¶ç”¨ `matplotlib` ç»˜åˆ¶é€Ÿåº¦/åŠ é€Ÿåº¦/è§’ä½ç§»æ›²çº¿ï¼›
  - ä½œä¸ºå®éªŒè®°å½•ä¸å¯è§†åŒ–å…¥å£ã€‚



---

## 1. æ¨¡å‹ç®€ä»‹

ç³»ç»Ÿæ˜¯é•¿åº¦ä¸º 
ğ¿
Lã€è´¨é‡ä¸º 
ğ‘š
m çš„æ‘†ï¼Œè€ƒè™‘é‡åŠ›ã€æ°”åŠ¨ï¼ˆæˆ–é˜»åŠ›ï¼‰é¡¹ä¸ å—æ§æ°´å¹³æ¨åŠ›ï¼ˆåœ¨å°è§’çª—å†…ï¼Œéšè§’é€Ÿåº¦æ–¹å‘æ–½åŠ ï¼‰ï¼Œä»¥åŠ åº•éƒ¨åå‘åˆ¹è½¦ï¼ˆåœ¨é è¿‘ç«–ç›´é™„è¿‘æŒ‰è§’åº¦ä¸è§’é€Ÿåº¦è‡ªé€‚åº”åœ°ç»™åå‘åŠ›ï¼‰ã€‚

åŠ¨åŠ›å­¦é‡‡ç”¨éçº¿æ€§æ–¹ç¨‹ï¼š

ğœƒ
Â¨
=
âˆ’
ğ‘”
ğ¿
sin
â¡
ğœƒ
+
ğ¹
â„
ğ‘š
ğ¿
cos
â¡
ğœƒ
+
ğœ…
0
ğ‘”
ğ¿
sin
â¡
ğœƒ
cos
â¡
ğœƒ
â€‰
sgn
â¡
(
ğœƒ
Ë™
)
âˆ’
ğ‘
ğ‘¡
ğ‘š
ğœƒ
Ë™
Î¸
Â¨
=âˆ’
L
g
	â€‹

sinÎ¸+
mL
F
h
	â€‹

	â€‹

cosÎ¸+
L
Îº
0
	â€‹

g
	â€‹

sinÎ¸cosÎ¸sgn(
Î¸
Ë™
)âˆ’
m
c
t
	â€‹

	â€‹

Î¸
Ë™

å…¶ä¸­ï¼Œ
ğœ…
0
Îº
0
	â€‹

 ä¸ºæ‰°åŠ¨å¹…åº¦ç³»æ•°ï¼Œç¬¦å·é¡¹ 
sgn
â¡
(
ğœƒ
Ë™
)
sgn(
Î¸
Ë™
) è¡¨ç¤ºæ–¹å‘ä¾èµ–æ€§ã€‚

**å‘½ä¸­-å‡æ¨æ§åˆ¶**ï¼šå½“è¾¾åˆ°ç›®æ ‡æè§’ \\(\\theta_{\\text{target}}\\)ï¼ˆå…è®¸å®¹å·®ï¼‰è®¡ä¸€æ¬¡â€œå‘½ä¸­â€ï¼›æ¯æ¬¡å‘½ä¸­åå°†æ¨åŠ›å¹…å€¼æŒ‰ `hit_decay` è¡°å‡ï¼ˆä¸ä½äºä¸‹é™ `F0_min_frac*F0`ï¼‰ã€‚å½“ç´¯è®¡å‘½ä¸­æ¬¡æ•°è¾¾åˆ° `n_hits` æ—¶ï¼š**æ°¸ä¹…åœæ¨**ï¼Œå¹¶è¿›å…¥**åº•éƒ¨åå‘åˆ¹è½¦**é˜¶æ®µä»¥è¿…é€Ÿç¨³å®šã€‚

---

## 2. æ–‡ä»¶ç»“æ„

```
.
â”œâ”€â”€ pendulum_sim.py              # ä»¿çœŸæ ¸å¿ƒï¼šParams, simulate()
â”œâ”€â”€ demo.ipynb                   # å¯è§†åŒ–ç¤ºä¾‹ï¼šå‚æ•°è®¾ç½® + è°ƒç”¨ + ç”»å›¾
â””â”€â”€ README.md                    # ä½ æ­£åœ¨çœ‹çš„æ–‡æ¡£
```

---

## 3. ä¾èµ–ä¸ç¯å¢ƒ

- Python 3.9+ï¼ˆå»ºè®®ï¼‰
- ä»…ä»¿çœŸï¼šæ ‡å‡†åº“ `math`, `dataclasses`
- å¯è§†åŒ–ï¼ˆåœ¨ Notebook ä¸­ï¼‰ï¼š`matplotlib`

å®‰è£…ï¼š

```bash
pip install matplotlib
```

---

## 4. å¿«é€Ÿå¼€å§‹

### 4.1 åœ¨ Jupyter Notebook ä¸­

1. å°† `pendulum_sim.py` ä¸ `demo.ipynb` æ”¾åœ¨åŒä¸€ç›®å½•ï¼›
2. æ‰“å¼€ `demo.ipynb`ï¼Œè¿è¡Œæ‰€æœ‰å•å…ƒå³å¯å¾—åˆ° 4 å¼ å¸¸ç”¨æ›²çº¿ï¼š
   - åˆ‡å‘çº¿é€Ÿåº¦ `v_t(t)`
   - åˆ‡å‘çº¿åŠ é€Ÿåº¦ `a_t(t)`
   - è§’ä½ç§» `Î¸(t)`ï¼ˆå«ç›®æ ‡è§’ Â±target å‚è€ƒçº¿ï¼‰
   - å¾„å‘åŠ é€Ÿåº¦ `a_r(t) = -LÂ·Ï‰Â²`

### 4.2 åœ¨ Python è„šæœ¬ä¸­è°ƒç”¨

```python
from pendulum_sim import Params, simulate

p = Params(
    m=250.0, L=24.0, g=9.81,
    kappa0=0.03, c_t=10.0,
    F0=6000.0,
    theta_on_deg=5.0,
    theta_target_deg=80.0,
    dt=0.002, t_max=200.0,
    n_hits=10, hit_decay=0.95, F0_min_frac=0.80,
    peak_eps_deg=0.5,
    theta_tol_deg=0.2, omega_tol_deg=0.2,
    quiet_time=5.0,
    brake_after_hits=None,          # é»˜è®¤ä¸ n_hits ç›¸åŒï¼Œæˆ–å¯æ‰‹åŠ¨æŒ‡å®š
    F_brake0=1000.0,
    theta_brake_on_deg=5.0,
    omega_eps=0.05,
    theta_eps_deg=0.3,
    stall_timeout=60.0,
    stall_cycles=4
)

out = simulate(p)
T = out["t"]
theta_deg = out["theta_deg"]
# å…¶ä½™é”®è§ä¸‹æ–‡â€œè¾“å‡ºè¯´æ˜â€
```

---

## 5. ä¸»è¦å‚æ•°ï¼ˆ`Params`ï¼‰

> ä»¥ä¸‹å­—æ®µåå¯èƒ½ä¸ä½ æœ€åˆè„šæœ¬ä¸­çš„ä¸­æ–‡æ³¨é‡Šä¸€ä¸€å¯¹åº”ï¼›æ­¤å¤„ç»Ÿä¸€ä¸ºå¯è¯»çš„è‹±æ–‡å­—æ®µå¹¶æä¾›â€œ*_degâ€ä¾¿æ·è§’åº¦å•ä½ã€‚

| å‚æ•°å | å«ä¹‰ | å…¸å‹å€¼/å»ºè®® |
|---|---|---|
| `m` | è´¨é‡ (kg) | 250.0 |
| `L` | æ‘†é•¿ (m) | 24.0 |
| `g` | é‡åŠ›åŠ é€Ÿåº¦ (m/sÂ²) | 9.81 |
| `kappa0` | åŠ¨æ€æ”¯æŒåŠ›åˆ‡å‘åˆ†é‡ç³»æ•°åŸºå‡† | 0.03 |
| `c_t` | åˆ‡å‘é˜»å°¼ç³»æ•° | 10.0 |
| `F0` | åˆå§‹æ¨åŠ›å¹…å€¼ (N) | 6000.0 |
| `theta_on_deg` | å°è§’çª—é˜ˆå€¼ï¼ˆä»…åœ¨ |Î¸|â‰¤è¯¥è§’æ—¶ç»™åŠ›ï¼‰ | 5.0Â° |
| `theta_target_deg` | ç›®æ ‡æè§’ï¼ˆå‘½ä¸­é˜ˆå€¼ï¼‰ | 80.0Â° |
| `dt` | ç§¯åˆ†æ­¥é•¿ (s) | 0.002 |
| `t_max` | æœ€å¤§ä»¿çœŸæ—¶é•¿ (s) | 200.0 |
| `n_hits` | éœ€è¦å‘½ä¸­çš„æ¬¡æ•°ï¼ˆè¾¾åˆ°ç›®æ ‡æè§’ï¼‰ | 10 |
| `hit_decay` | æ¯æ¬¡å‘½ä¸­åæ¨åŠ›è¡°å‡å› å­ | 0.95 |
| `F0_min_frac` | æ¨åŠ›ä¸‹é™ï¼ˆç›¸å¯¹åˆå§‹ `F0`ï¼‰ | 0.80 |
| `peak_eps_deg` | å‘½ä¸­è§’å®¹å·® | 0.5Â° |
| `theta_tol_deg` | åœæœºåˆ¤æ®çš„è§’åº¦é˜ˆå€¼ | 0.2Â° |
| `omega_tol_deg` | åœæœºåˆ¤æ®çš„è§’é€Ÿåº¦é˜ˆå€¼ | 0.2Â°/s |
| `quiet_time` | æ»¡è¶³å°è§’å°é€Ÿéœ€æŒç»­çš„æ—¶é—´ (s) | 5.0 |
| `brake_after_hits` | è§¦å‘åº•éƒ¨åˆ¹è½¦çš„å‘½ä¸­æ¬¡æ•°ï¼ˆé»˜è®¤ä¸ `n_hits` ç›¸åŒï¼‰ | - |
| `F_brake0` | åº•éƒ¨åå‘åˆ¹è½¦å³°å€¼ (N) | 1000.0 |
| `theta_brake_on_deg` | åˆ¹è½¦åªåœ¨è¯¥å°è§’çª—å†…ç”Ÿæ•ˆ | 5.0Â° |
| `omega_eps` | è¿‘é›¶é€Ÿé—¨é™ (rad/s) | 0.05 |
| `theta_eps_deg` | è¿‘é›¶è§’é—¨é™ (deg) | 0.3Â° |
| `stall_timeout` | åœæ¨é˜²å¡æ­»ï¼šè‡ªä¸Šæ¬¡å‘½èµ·è¶…è¿‡è¯¥ç§’æ•°åˆ™åœæ¨ | 60 s |
| `stall_cycles` | åœæ¨é˜²å¡æ­»ï¼šè¿ç»­é”™è¿‡å³°å€¼çš„æ¬¡æ•°é˜ˆå€¼ | 4 |

---

## 6. è¾“å‡ºè¯´æ˜ï¼ˆ`simulate(params)` è¿”å›ï¼‰

`simulate` è¿”å›ä¸€ä¸ª `dict`ï¼ŒåŒ…å«æ—¶é—´åºåˆ—ä¸å…ƒä¿¡æ¯ï¼š

- **æ—¶é—´åºåˆ—**
  - `t`ï¼šæ—¶é—´ (s)
  - `theta`ï¼šè§’ä½ç§» (rad)
  - `theta_deg`ï¼šè§’ä½ç§» (deg)
  - `omega`ï¼šè§’é€Ÿåº¦ (rad/s)
  - `Fh`ï¼šå®é™…æ–½åŠ çš„æ°´å¹³æ¨åŠ› (N)ï¼Œå«å‘½ä¸­-å‡æ¨ä¸åº•éƒ¨åˆ¹è½¦å åŠ 
  - `v_t`ï¼šåˆ‡å‘çº¿é€Ÿåº¦ (m/s)ï¼Œ\\(v_t = L\\,\\omega\\)
  - `a_t`ï¼šåˆ‡å‘çº¿åŠ é€Ÿåº¦ (m/sÂ²)ï¼Œæ¥è‡ªæ¨¡å‹å³ç«¯é¡¹
  - `a_r`ï¼šå¾„å‘åŠ é€Ÿåº¦ (m/sÂ²)ï¼Œ\\(a_r = -L\\,\\omega^2\\)
- **å…ƒä¿¡æ¯**
  - `meta.hit_count`ï¼šæœ€ç»ˆå‘½ä¸­æ¬¡æ•°
  - `meta.brake_on`ï¼šæ˜¯å¦è¿›å…¥è¿‡åº•éƒ¨åˆ¹è½¦é˜¶æ®µ
  - `meta.sim_end_time`ï¼šå®é™…ä»¿çœŸåœæ­¢æ—¶åˆ»ï¼ˆå¯èƒ½æ—©äº `t_max`ï¼‰

> æ³¨ï¼šNotebook ä¸­æ¼”ç¤ºäº†å¦‚ä½•ä» `out` ä¸­å– `T/VT/AT/AR/Î¸(t)` ç­‰å¹¶ç»˜å›¾ã€‚

---

## 7. å¯è§†åŒ–ï¼ˆNotebook ä¸­ç¤ºä¾‹ï¼‰

- `Tangential linear velocity vs time`
- `Tangential linear acceleration vs time`
- `Angular displacement vs time`ï¼ˆå« Â±target å‚è€ƒçº¿ï¼‰
- `Radial acceleration vs time (a_r = -LÂ·Ï‰Â²)`

ä½ å¯æŒ‰éœ€æ–°å¢ï¼š
- æ¨åŠ›ã€é«˜åº¦æ—¶åº `Fh(t)`ï¼›
- å‘½ä¸­äº‹ä»¶æ ‡è®°ï¼ˆåœ¨å³°å€¼å¤„æ•£ç‚¹/ç«–çº¿ï¼‰ï¼›

---



